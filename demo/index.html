<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mpr-ui Demo</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/MarcoPoloResearchLab/mpr-ui@0.0.8/mpr-ui.css"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/module.esm.js"
      type="module"
    ></script>
    <script
      id="mpr-ui-bundle"
      defer
      src="https://cdn.jsdelivr.net/gh/MarcoPoloResearchLab/mpr-ui@0.0.8/mpr-ui.js"
    ></script>
    <script
      src="https://accounts.google.com/gsi/client"
      async
      defer
    ></script>
  </head>
  <body data-demo-palette="default">
    <div
      id="g_id_onload"
      data-client_id="991677581607-r0dj8q6irjagipali0jpca7nfp8sfj9r.apps.googleusercontent.com"
      data-auto_prompt="false"
      hidden
    ></div>
    <div
      id="site-header"
      data-theme-toggle='{"attribute":"data-demo-theme","targets":["body"],"modes":[{"value":"light","classList":["theme-light"],"dataset":{"demo-theme":"light"}},{"value":"dark","classList":["theme-dark"],"dataset":{"demo-theme":"dark"}}]}'
      data-theme-mode="dark"
    ></div>
    <main>
      <h1>mpr-ui Demo</h1>
      <p>
        This page runs entirely offline and demonstrates how to use the
        <strong>authentication header</strong> and <strong>footer</strong>
        helpers provided by <code>mpr-ui.js</code>.
      </p>

      <section aria-labelledby="auth-demo-title">
        <h2 id="auth-demo-title">Authentication Header</h2>
        <p>
          The mock gateway below simulates Google Identity Services and backend
          endpoints. Use the buttons to trigger credential exchanges and observe
          emitted events.
        </p>

        <div class="auth-card">
          <p>
            Interact with the header at the top of the page and observe how the
            dataset and events change below.
          </p>

          <div class="auth-actions">
            <button id="trigger-prompt">Prompt Sign-In</button>
            <button class="secondary" id="sign-out">Sign Out</button>
            <button class="secondary" id="restart-session">
              Restart Session Watcher
            </button>
          </div>

          <div>
            <h3>Current Profile Dataset</h3>
            <dl id="profile-dataset">
              <dt>data-user-id</dt>
              <dd id="profile-id">—</dd>
              <dt>data-user-email</dt>
              <dd id="profile-email">—</dd>
              <dt>data-user-display</dt>
              <dd id="profile-display">—</dd>
              <dt>data-user-avatar-url</dt>
              <dd id="profile-avatar">—</dd>
            </dl>
          </div>

          <div>
            <h3>Event Log</h3>
            <div id="event-log" class="event-log" aria-live="polite"></div>
          </div>
        </div>

        <pre><code>// demo/auth configuration (see demo.js)
const controller = MPRUI.createAuthHeader(host, {
  loginPath: "/auth/google",
  logoutPath: "/auth/logout",
  noncePath: "/auth/nonce",
});
</code></pre>
      </section>

      <section aria-labelledby="footer-demo-title">
        <h2 id="footer-demo-title">Footer Helpers</h2>
        <p>
          The first example uses Alpine's <code>x-data</code> factory; the sticky
          footer at the bottom of the page is mounted imperatively so you can
          rotate its links in real time. Try toggling the theme switch or opening
          the menu to see emitted events.
        </p>

        <div
          id="alpine-footer"
          x-data="(() => {
            const fetchCatalog = window.MPRUI && typeof window.MPRUI.getFooterSiteCatalog === 'function'
              ? window.MPRUI.getFooterSiteCatalog
              : () => [];
            return mprFooter({
              prefixText: 'Built by',
              toggleLabel: 'MPRLab Sites',
              links: fetchCatalog()
            });
          })()"
          x-init="init()"
        ></div>

        <div class="auth-actions" style="margin-top: 1rem">
          <button id="rotate-footer">Rotate Footer Links</button>
        </div>
      </section>

      <section aria-labelledby="theme-demo-title">
        <h2 id="theme-demo-title">Shared Theme Tokens</h2>
        <p>
          The header and footer now respond to CSS custom properties exported by
          <code>mpr-ui.js</code>. Pick a palette to override the shared tokens without touching JavaScript.
        </p>
        <div class="auth-actions">
          <button data-demo-palette-toggle="default">Default Palette</button>
          <button data-demo-palette-toggle="sunrise">Sunrise Palette</button>
          <button data-demo-palette-toggle="forest">Forest Palette</button>
        </div>
        <div class="auth-actions" style="margin-top: 1rem">
          <button data-demo-theme-mode="light">Switch to Light Mode</button>
          <button data-demo-theme-mode="dark">Switch to Dark Mode</button>
        </div>
        <pre><code>body[data-demo-palette="sunrise"] {
  --mpr-color-surface-primary: rgba(252,232,222,0.92);
  --mpr-color-accent: #f97316;
}</code></pre>
      </section>

      <section aria-labelledby="ce-demo-title">
        <h2 id="ce-demo-title">Custom Elements</h2>
        <p>
          Prefer declarative markup? Drop in the `<mpr-header>` and `<mpr-footer>`
          tags and configure them with HTML attributes. Slots let you inject custom
          actions without leaving template land.
        </p>
        <div class="custom-elements-preview">
          <mpr-header
            brand-label="Custom Research"
            brand-href="/"
            nav-links='[
              { "label": "Docs", "href": "#docs" },
              { "label": "Support", "href": "#support" }
            ]'
            site-id="991677581607-r0dj8q6irjagipali0jpca7nfp8sfj9r.apps.googleusercontent.com"
            theme-config='{"initialMode":"light"}'
          >
            <button slot="nav-right" class="demo-link">Request Access</button>
          </mpr-header>
          <mpr-footer
            prefix-text="Built with"
            privacy-link-label="Privacy &amp; Terms"
            links='[{ "label": "Docs", "url": "#docs" }]'
          >
            <span slot="menu-prefix">Explore</span>
            <a
              slot="menu-links"
              href="https://mprlab.com"
              target="_blank"
              rel="noopener noreferrer"
            >
              Visit mprlab.com
            </a>
            <small slot="legal">© Marco Polo Research</small>
          </mpr-footer>
        </div>
      </section>
    </main>

    <div
      id="imperative-footer-host"
      class="demo-footer-slot"
      aria-label="Sticky footer host"
    ></div>

    <script type="module" src="./demo.js"></script>
  </body>
</html>
