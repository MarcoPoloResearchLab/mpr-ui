<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mpr-ui Demo</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      #site-header {
        position: sticky;
        top: 0;
        width: 100%;
        z-index: 1200;
        flex-shrink: 0;
      }

      .demo-footer-slot {
        position: sticky;
        bottom: 0;
        width: 100%;
        z-index: 1200;
        flex-shrink: 0;
        margin-top: auto;
      }

      body[data-demo-palette="default"] {
        background: none;
      }

      body[data-demo-palette="sunrise"] {
        --mpr-color-surface-primary: rgba(252, 232, 222, 0.92);
        --mpr-color-surface-elevated: rgba(255, 247, 237, 0.98);
        --mpr-color-text-primary: #7c2d12;
        --mpr-color-text-muted: #9a3412;
        --mpr-color-border: rgba(249, 210, 179, 0.6);
        --mpr-color-divider: rgba(253, 186, 116, 0.6);
        --mpr-chip-bg: rgba(249, 115, 22, 0.18);
        --mpr-chip-hover-bg: rgba(249, 115, 22, 0.28);
        --mpr-menu-hover-bg: rgba(251, 146, 60, 0.18);
        --mpr-color-accent: #f97316;
        --mpr-color-accent-alt: #fb923c;
        --mpr-color-accent-contrast: #fff7ed;
        --mpr-theme-toggle-bg: rgba(251, 191, 36, 0.2);
        --mpr-shadow-elevated: 0 10px 24px rgba(124, 45, 18, 0.18);
        --mpr-shadow-flyout: 0 18px 36px rgba(124, 45, 18, 0.22);
        background-image: linear-gradient(135deg, #fff7ed 0%, #fde68a 100%);
        color: #7c2d12;
      }

      body[data-demo-palette="forest"] {
        --mpr-color-surface-primary: rgba(17, 42, 36, 0.94);
        --mpr-color-surface-elevated: rgba(13, 35, 30, 0.98);
        --mpr-color-text-primary: #dcfce7;
        --mpr-color-text-muted: #86efac;
        --mpr-color-border: rgba(134, 239, 172, 0.3);
        --mpr-color-divider: rgba(34, 197, 94, 0.4);
        --mpr-chip-bg: rgba(34, 197, 94, 0.2);
        --mpr-chip-hover-bg: rgba(34, 197, 94, 0.32);
        --mpr-menu-hover-bg: rgba(21, 128, 61, 0.35);
        --mpr-color-accent: #22c55e;
        --mpr-color-accent-alt: #16a34a;
        --mpr-color-accent-contrast: #052e16;
        --mpr-theme-toggle-bg: rgba(34, 197, 94, 0.18);
        --mpr-shadow-elevated: 0 10px 24px rgba(5, 46, 22, 0.4);
        --mpr-shadow-flyout: 0 18px 36px rgba(5, 46, 22, 0.5);
        background-image: linear-gradient(135deg, #022c22 0%, #065f46 100%);
        color: #dcfce7;
      }

      body[data-demo-palette="sunrise"] main,
      body[data-demo-palette="forest"] main {
        transition: background 0.3s ease, color 0.3s ease;
      }

      body.theme-light {
        background-color: #f8fafc;
        color: #0f172a;
      }

      body.theme-dark {
        background-color: #0f172a;
        color: #e2e8f0;
      }

      body.theme-light main {
        color: #0f172a;
      }

      body.theme-dark main {
        color: #e2e8f0;
      }

      body.theme-light section {
        background: rgba(255, 255, 255, 0.92);
        border-color: rgba(148, 163, 184, 0.35);
        box-shadow: 0 16px 40px rgba(15, 23, 42, 0.08);
      }

      body.theme-light .auth-card {
        background: rgba(226, 232, 240, 0.65);
        color: #0f172a;
      }

      body.theme-light .event-log {
        background: rgba(241, 245, 249, 0.9);
        border-color: rgba(148, 163, 184, 0.4);
        color: #0f172a;
      }

      body.theme-light pre {
        background: #f1f5f9;
        color: #0f172a;
        border: 1px solid rgba(148, 163, 184, 0.35);
      }

      body.theme-light button {
        color: #0f172a;
      }

      body.theme-light button.secondary {
        background: rgba(148, 163, 184, 0.22);
        color: #0f172a;
      }

      body.theme-light code {
        color: #0f172a;
      }

      main {
        flex: 1 0 auto;
        padding: 6rem 1.5rem 6rem;
        max-width: 960px;
        margin: 0 auto;
      }

      h1,
      h2 {
        color: #38bdf8;
      }

      section {
        margin-bottom: 3rem;
        padding: 1.5rem;
        border: 1px solid rgba(148, 163, 184, 0.35);
        border-radius: 0.75rem;
        background: rgba(15, 23, 42, 0.65);
        backdrop-filter: blur(4px);
      }

      pre {
        background: rgba(15, 23, 42, 0.85);
        padding: 0.75rem;
        border-radius: 0.5rem;
        overflow-x: auto;
        margin: 1rem 0;
      }

      code {
        font-family: "Fira Code", "SFMono-Regular", Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 0.875rem;
      }

      .auth-card {
        display: grid;
        gap: 1rem;
        background: rgba(30, 41, 59, 0.6);
        border-radius: 0.75rem;
        padding: 1.5rem;
      }

      .auth-actions {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
      }

      button {
        background: #38bdf8;
        color: #0f172a;
        border: none;
        border-radius: 999px;
        padding: 0.6rem 1.2rem;
        font-weight: 600;
        cursor: pointer;
      }

      button.secondary {
        background: rgba(148, 163, 184, 0.2);
        color: #e2e8f0;
      }

      button:focus-visible {
        outline: 3px solid #f59e0b;
        outline-offset: 2px;
      }

      .event-log {
        max-height: 200px;
        overflow-y: auto;
        border: 1px solid rgba(148, 163, 184, 0.25);
        border-radius: 0.5rem;
        padding: 0.75rem;
        background: rgba(15, 23, 42, 0.85);
        font-size: 0.85rem;
      }

      dl {
        display: grid;
        grid-template-columns: max-content 1fr;
        gap: 0.5rem 1rem;
        margin: 0;
      }

      dt {
        font-weight: 600;
        color: #38bdf8;
      }

      footer {
        flex-shrink: 0;
      }
    </style>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/module.esm.js"
      type="module"
    ></script>
    <script
      id="mpr-ui-bundle"
      defer
      src="https://cdn.jsdelivr.net/gh/MarcoPoloResearchLab/mpr-ui@0.0.5/mpr-ui.js"
    ></script>
  </head>
  <body data-demo-palette="default">
    <div
      id="site-header"
      data-theme-toggle='{"attribute":"data-demo-theme","targets":["body"],"modes":[{"value":"light","classList":["theme-light"],"dataset":{"demo-theme":"light"}},{"value":"dark","classList":["theme-dark"],"dataset":{"demo-theme":"dark"}}]}'
      data-theme-mode="dark"
    ></div>
    <main>
      <h1>mpr-ui Demo</h1>
      <p>
        This page runs entirely offline and demonstrates how to use the
        <strong>authentication header</strong> and <strong>footer</strong>
        helpers provided by <code>mpr-ui.js</code>.
      </p>

      <section aria-labelledby="auth-demo-title">
        <h2 id="auth-demo-title">Authentication Header</h2>
        <p>
          The mock gateway below simulates Google Identity Services and backend
          endpoints. Use the buttons to trigger credential exchanges and observe
          emitted events.
        </p>

        <div class="auth-card">
          <p>
            Interact with the header at the top of the page and observe how the
            dataset and events change below.
          </p>

          <div class="auth-actions">
            <button id="trigger-prompt">Prompt Sign-In</button>
            <button id="complete-sign-in">Complete Sign-In</button>
            <button class="secondary" id="sign-out">Sign Out</button>
            <button class="secondary" id="restart-session">
              Restart Session Watcher
            </button>
          </div>

          <div>
            <h3>Current Profile Dataset</h3>
            <dl id="profile-dataset">
              <dt>data-user-id</dt>
              <dd id="profile-id">—</dd>
              <dt>data-user-email</dt>
              <dd id="profile-email">—</dd>
              <dt>data-user-display</dt>
              <dd id="profile-display">—</dd>
              <dt>data-user-avatar-url</dt>
              <dd id="profile-avatar">—</dd>
            </dl>
          </div>

          <div>
            <h3>Event Log</h3>
            <div id="event-log" class="event-log" aria-live="polite"></div>
          </div>
        </div>

        <pre><code>// demo/auth configuration (see demo.js)
const controller = MPRUI.createAuthHeader(host, {
  loginPath: "/auth/google",
  logoutPath: "/auth/logout",
  noncePath: "/auth/nonce",
});
</code></pre>
      </section>

      <section aria-labelledby="footer-demo-title">
        <h2 id="footer-demo-title">Footer Helpers</h2>
        <p>
          The first example uses Alpine's <code>x-data</code> factory; the sticky
          footer at the bottom of the page is mounted imperatively so you can
          rotate its links in real time. Try toggling the theme switch or opening
          the menu to see emitted events.
        </p>

        <div
          id="alpine-footer"
          x-data="mprFooter({
            prefixText: 'Built by',
            toggleLabel: 'Marco Polo Research Lab',
            links: [
              { label: 'Marco Polo Research Lab', url: 'https://mprlab.com' },
              { label: 'LoopAware', url: 'https://loopaware.mprlab.com' }
            ]
          })"
          x-init="init()"
        ></div>

        <div class="auth-actions" style="margin-top: 1rem">
          <button id="rotate-footer">Rotate Footer Links</button>
        </div>
      </section>

      <section aria-labelledby="theme-demo-title">
        <h2 id="theme-demo-title">Shared Theme Tokens</h2>
        <p>
          The header and footer now respond to CSS custom properties exported by
          <code>mpr-ui.js</code>. Pick a palette to override the shared tokens without touching JavaScript.
        </p>
        <div class="auth-actions">
          <button data-demo-palette-toggle="default">Default Palette</button>
          <button data-demo-palette-toggle="sunrise">Sunrise Palette</button>
          <button data-demo-palette-toggle="forest">Forest Palette</button>
        </div>
        <div class="auth-actions" style="margin-top: 1rem">
          <button data-demo-theme-mode="light">Switch to Light Mode</button>
          <button data-demo-theme-mode="dark">Switch to Dark Mode</button>
        </div>
        <pre><code>body[data-demo-palette="sunrise"] {
  --mpr-color-surface-primary: rgba(252,232,222,0.92);
  --mpr-color-accent: #f97316;
}</code></pre>
      </section>
    </main>

    <div
      id="imperative-footer-host"
      class="demo-footer-slot"
      aria-label="Sticky footer host"
    ></div>

    <script type="module" src="./demo.js"></script>
  </body>
</html>
